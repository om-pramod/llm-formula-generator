name: ğŸ§ª Test LLM Formula Generator

on:
  push:
    branches: [ main, develop, master ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        node-version: [16.x, 18.x, 20.x]
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v3
    
    - name: ğŸ—ï¸ Setup Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
        cache-dependency-path: package-lock.json
    
    - name: ğŸ“¦ Install dependencies
      run: npm ci
    
    - name: ğŸ§ª Run comprehensive test suite
      run: npm test
      env:
        NODE_ENV: test

  documentation-check:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v3
    
    - name: ğŸ“‹ Verify documentation completeness
      run: |
        echo "Checking required documentation files..."
        
        required_files=(
          "README.md"
          "QUICKSTART.md" 
          "SHOWCASE.md"
          "TESTING.md"
          "LICENSE"
          "package.json"
          "apps-script/Code.gs"
          "server/formulas.js"
          "server/server.js"
        )
        
        missing_files=()
        
        for file in "${required_files[@]}"; do
          if [ -f "$file" ]; then
            echo "âœ… $file"
          else
            echo "âŒ $file (missing)"
            missing_files+=("$file")
          fi
        done
        
        if [ ${#missing_files[@]} -eq 0 ]; then
          echo "ğŸ“š All documentation files present"
        else
          echo "âŒ Missing documentation files: ${missing_files[*]}"
          exit 1
        fi
    
    - name: ğŸ” Check documentation quality
      run: |
        echo "Checking documentation quality..."
        
        # Check README has key sections
        if grep -q "Quick Start" README.md && \
           grep -q "Testing" README.md && \
           grep -q "Usage" README.md; then
          echo "âœ… README.md has all required sections"
        else
          echo "âŒ README.md missing key sections"
          exit 1
        fi
        
        # Check QUICKSTART.md
        if grep -q "Setup" QUICKSTART.md && \
           grep -q "Test" QUICKSTART.md; then
          echo "âœ… QUICKSTART.md is complete"
        else
          echo "âŒ QUICKSTART.md is incomplete"
          exit 1
        fi
        
        echo "ğŸ“– Documentation quality check passed"

  deployment-readiness:
    runs-on: ubuntu-latest
    needs: [test, documentation-check]
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v3
    
    - name: âœ… Deployment readiness check
      run: |
        echo "ğŸ‰ All tests passed! Project is ready for deployment."
        echo ""
        echo "ğŸ“‹ Deployment Options:"
        echo "  1. GitHub Codespaces (60h/month free)"
        echo "  2. Local development (unlimited)"
        echo "  3. Railway.app (free tier)" 
        echo "  4. Replit (public demo)"
        echo ""
        echo "ğŸš€ Next steps:"
        echo "  1. Choose deployment platform"
        echo "  2. Follow QUICKSTART.md guide"
        echo "  3. Test with Google Sheets"
        echo ""
        echo "ğŸ’¡ No GitHub Codespaces hours consumed during testing!"

# Last updated: 2025-08-14 22:01:54
# Author: om-pramod
